<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <title>LCOV - PHP Code Coverage - Zend/zend_execute.h</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
        <tr>
          <td width="5%"></td>
          <td width="10%" class="headerItem">Current view:</td>
          <td width="35%" class="headerValue"><a href="../index.html">directory</a> - <a href="index.html">Zend</a> - zend_execute.h (source / <a href="zend_execute.h.func.html">functions</a>)</td>
          <td width="10%"></td>
          <td width="10%" class="headerCovTableHead">Found</td>
          <td width="10%" class="headerCovTableHead">Hit</td>
          <td width="15%" class="headerCovTableHead">Coverage</td>
          <td width="5%"></td>
        </tr>
        <tr>
          <td></td>
          <td class="headerItem">Test:</td>
          <td class="headerValue">PHP Code Coverage</td>
          <td class="headerItem">Lines:</td>
          <td class="headerCovTableEntry">98</td>
          <td class="headerCovTableEntry">57</td>
          <td class="headerCovTableEntryHi">58.2 %</td>
        </tr>
        <tr>
          <td></td>
          <td class="headerItem">Date:</td>
          <td class="headerValue">2012-06-19</td>
          <td class="headerItem">Functions:</td>
          <td class="headerCovTableEntry">0</td>
          <td class="headerCovTableEntry">0</td>
          <td class="headerCovTableEntryHi">-</td>
        </tr>
        <tr>
          <td></td>
          <td class="headerItem">Colors:</td>
          <td class="headerValueLeg" colspan=5>
            <span class="coverLegendNoCov">not hit</span>
            <span class="coverLegendCov">hit</span>
          </td>
        </tr>
                <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td><pre class="source">
<a name="1"><span class="lineNum">       1 </span>                : /*</a>
<span class="lineNum">       2 </span>                :    +----------------------------------------------------------------------+
<span class="lineNum">       3 </span>                :    | Zend Engine                                                          |
<span class="lineNum">       4 </span>                :    +----------------------------------------------------------------------+
<span class="lineNum">       5 </span>                :    | Copyright (c) 1998-2012 Zend Technologies Ltd. (http://www.zend.com) |
<span class="lineNum">       6 </span>                :    +----------------------------------------------------------------------+
<span class="lineNum">       7 </span>                :    | This source file is subject to version 2.00 of the Zend license,     |
<span class="lineNum">       8 </span>                :    | that is bundled with this package in the file LICENSE, and is        | 
<span class="lineNum">       9 </span>                :    | available through the world-wide-web at the following url:           |
<span class="lineNum">      10 </span>                :    | http://www.zend.com/license/2_00.txt.                                |
<span class="lineNum">      11 </span>                :    | If you did not receive a copy of the Zend license and are unable to  |
<span class="lineNum">      12 </span>                :    | obtain it through the world-wide-web, please send a note to          |
<span class="lineNum">      13 </span>                :    | license@zend.com so we can mail you a copy immediately.              |
<span class="lineNum">      14 </span>                :    +----------------------------------------------------------------------+
<span class="lineNum">      15 </span>                :    | Authors: Andi Gutmans &lt;andi@zend.com&gt;                                |
<span class="lineNum">      16 </span>                :    |          Zeev Suraski &lt;zeev@zend.com&gt;                                |
<span class="lineNum">      17 </span>                :    +----------------------------------------------------------------------+
<span class="lineNum">      18 </span>                : */
<span class="lineNum">      19 </span>                : 
<span class="lineNum">      20 </span>                : /* $Id$ */
<span class="lineNum">      21 </span>                : 
<span class="lineNum">      22 </span>                : #ifndef ZEND_EXECUTE_H
<span class="lineNum">      23 </span>                : #define ZEND_EXECUTE_H
<span class="lineNum">      24 </span>                : 
<span class="lineNum">      25 </span>                : #include &quot;zend_compile.h&quot;
<span class="lineNum">      26 </span>                : #include &quot;zend_hash.h&quot;
<span class="lineNum">      27 </span>                : #include &quot;zend_operators.h&quot;
<span class="lineNum">      28 </span>                : #include &quot;zend_variables.h&quot;
<span class="lineNum">      29 </span>                : 
<span class="lineNum">      30 </span>                : typedef union _temp_variable {
<span class="lineNum">      31 </span>                :         zval tmp_var;
<span class="lineNum">      32 </span>                :         struct {
<span class="lineNum">      33 </span>                :                 zval **ptr_ptr;
<span class="lineNum">      34 </span>                :                 zval *ptr;
<span class="lineNum">      35 </span>                :                 zend_bool fcall_returned_reference;
<span class="lineNum">      36 </span>                :         } var;
<span class="lineNum">      37 </span>                :         struct {
<span class="lineNum">      38 </span>                :                 zval **ptr_ptr; /* shared with var.ptr_ptr */
<span class="lineNum">      39 </span>                :                 zval *str;
<span class="lineNum">      40 </span>                :                 zend_uint offset;
<span class="lineNum">      41 </span>                :         } str_offset;
<span class="lineNum">      42 </span>                :         struct {
<span class="lineNum">      43 </span>                :                 zval **ptr_ptr; /* shared with var.ptr_ptr */
<span class="lineNum">      44 </span>                :                 zval *ptr;      /* shared with var.ptr */
<span class="lineNum">      45 </span>                :                 HashPointer fe_pos;
<span class="lineNum">      46 </span>                :         } fe;
<span class="lineNum">      47 </span>                :         zend_class_entry *class_entry;
<span class="lineNum">      48 </span>                : } temp_variable;
<span class="lineNum">      49 </span>                : 
<span class="lineNum">      50 </span>                : 
<span class="lineNum">      51 </span>                : BEGIN_EXTERN_C()
<span class="lineNum">      52 </span>                : ZEND_API extern void (*zend_execute)(zend_op_array *op_array TSRMLS_DC);
<span class="lineNum">      53 </span>                : ZEND_API extern void (*zend_execute_internal)(zend_execute_data *execute_data_ptr, int return_value_used TSRMLS_DC);
<span class="lineNum">      54 </span>                : 
<span class="lineNum">      55 </span>                : void init_executor(TSRMLS_D);
<span class="lineNum">      56 </span>                : void shutdown_executor(TSRMLS_D);
<span class="lineNum">      57 </span>                : void shutdown_destructors(TSRMLS_D);
<span class="lineNum">      58 </span>                : ZEND_API void execute(zend_op_array *op_array TSRMLS_DC);
<span class="lineNum">      59 </span>                : ZEND_API void execute_internal(zend_execute_data *execute_data_ptr, int return_value_used TSRMLS_DC);
<span class="lineNum">      60 </span>                : ZEND_API int zend_is_true(zval *op);
<span class="lineNum">      61 </span>                : #define safe_free_zval_ptr(p) safe_free_zval_ptr_rel(p ZEND_FILE_LINE_CC ZEND_FILE_LINE_EMPTY_CC)
<span class="lineNum">      62 </span>                : static zend_always_inline void safe_free_zval_ptr_rel(zval *p ZEND_FILE_LINE_DC ZEND_FILE_LINE_ORIG_DC)
<span class="lineNum">      63 </span>                : {
<span class="lineNum">      64 </span>                :         TSRMLS_FETCH();
<span class="lineNum">      65 </span>                : 
<span class="lineNum">      66 </span>                :         if (p!=EG(uninitialized_zval_ptr)) {
<span class="lineNum">      67 </span>                :                 FREE_ZVAL_REL(p);
<span class="lineNum">      68 </span>                :         }
<span class="lineNum">      69 </span>                : }
<span class="lineNum">      70 </span>                : ZEND_API int zend_lookup_class(const char *name, int name_length, zend_class_entry ***ce TSRMLS_DC);
<span class="lineNum">      71 </span>                : ZEND_API int zend_lookup_class_ex(const char *name, int name_length, const zend_literal *key, int use_autoload, zend_class_entry ***ce TSRMLS_DC);
<span class="lineNum">      72 </span>                : ZEND_API int zend_eval_string(char *str, zval *retval_ptr, char *string_name TSRMLS_DC);
<span class="lineNum">      73 </span>                : ZEND_API int zend_eval_stringl(char *str, int str_len, zval *retval_ptr, char *string_name TSRMLS_DC);
<span class="lineNum">      74 </span>                : ZEND_API int zend_eval_string_ex(char *str, zval *retval_ptr, char *string_name, int handle_exceptions TSRMLS_DC);
<span class="lineNum">      75 </span>                : ZEND_API int zend_eval_stringl_ex(char *str, int str_len, zval *retval_ptr, char *string_name, int handle_exceptions TSRMLS_DC);
<span class="lineNum">      76 </span>                : 
<span class="lineNum">      77 </span>                : ZEND_API char * zend_verify_arg_class_kind(const zend_arg_info *cur_arg_info, ulong fetch_type, const char **class_name, zend_class_entry **pce TSRMLS_DC);
<span class="lineNum">      78 </span>                : ZEND_API int zend_verify_arg_error(int error_type, const zend_function *zf, zend_uint arg_num, const char *need_msg, const char *need_kind, const char *given_msg, const char *given_kind TSRMLS_DC);
<span class="lineNum">      79 </span>                : 
<span class="lineNum">      80 </span>                : static zend_always_inline void i_zval_ptr_dtor(zval *zval_ptr ZEND_FILE_LINE_DC)
<span class="lineNum">      81 </span>                : {
<span class="lineNum">      82 </span><span class="lineCov">         264442 :         if (!Z_DELREF_P(zval_ptr)) {</span>
<span class="lineNum">      83 </span>                :                 TSRMLS_FETCH();
<span class="lineNum">      84 </span>                : 
<span class="lineNum">      85 </span><span class="lineCov">          66973 :                 if (zval_ptr != &amp;EG(uninitialized_zval)) {</span>
<span class="lineNum">      86 </span><span class="lineCov">          66973 :                         GC_REMOVE_ZVAL_FROM_BUFFER(zval_ptr);</span>
<span class="lineNum">      87 </span>                :                         zval_dtor(zval_ptr);
<span class="lineNum">      88 </span><span class="lineCov">          66973 :                         efree_rel(zval_ptr);</span>
<span class="lineNum">      89 </span>                :                 }
<span class="lineNum">      90 </span>                :         } else {
<span class="lineNum">      91 </span>                :                 TSRMLS_FETCH();
<span class="lineNum">      92 </span>                : 
<span class="lineNum">      93 </span><span class="lineCov">         197469 :                 if (Z_REFCOUNT_P(zval_ptr) == 1) {</span>
<span class="lineNum">      94 </span>                :                         Z_UNSET_ISREF_P(zval_ptr);
<span class="lineNum">      95 </span>                :                 }
<span class="lineNum">      96 </span>                : 
<span class="lineNum">      97 </span>                :                 GC_ZVAL_CHECK_POSSIBLE_ROOT(zval_ptr);
<span class="lineNum">      98 </span>                :         }
<span class="lineNum">      99 </span>                : }
<span class="lineNum">     100 </span>                : 
<span class="lineNum">     101 </span>                : static zend_always_inline int i_zend_is_true(zval *op)
<span class="lineNum">     102 </span>                : {
<span class="lineNum">     103 </span>                :         int result;
<span class="lineNum">     104 </span>                : 
<span class="lineNum">     105 </span><span class="lineCov">          37019 :         switch (Z_TYPE_P(op)) {</span>
<span class="lineNum">     106 </span>                :                 case IS_NULL:
<span class="lineNum">     107 </span><span class="lineCov">            129 :                         result = 0;</span>
<span class="lineNum">     108 </span>                :                         break;
<span class="lineNum">     109 </span>                :                 case IS_LONG:
<span class="lineNum">     110 </span>                :                 case IS_BOOL:
<span class="lineNum">     111 </span>                :                 case IS_RESOURCE:
<span class="lineNum">     112 </span><span class="lineCov">          36786 :                         result = (Z_LVAL_P(op)?1:0);</span>
<span class="lineNum">     113 </span>                :                         break;
<span class="lineNum">     114 </span>                :                 case IS_DOUBLE:
<span class="lineNum">     115 </span><span class="lineNoCov">              0 :                         result = (Z_DVAL_P(op) ? 1 : 0);</span>
<span class="lineNum">     116 </span>                :                         break;
<span class="lineNum">     117 </span>                :                 case IS_STRING:
<span class="lineNum">     118 </span><span class="lineCov">            194 :                         if (Z_STRLEN_P(op) == 0</span>
<span class="lineNum">     119 </span><span class="lineCov">            194 :                                 || (Z_STRLEN_P(op)==1 &amp;&amp; Z_STRVAL_P(op)[0]=='0')) {</span>
<span class="lineNum">     120 </span><span class="lineNoCov">              0 :                                 result = 0;</span>
<span class="lineNum">     121 </span>                :                         } else {
<span class="lineNum">     122 </span><span class="lineCov">             97 :                                 result = 1;</span>
<span class="lineNum">     123 </span>                :                         }
<span class="lineNum">     124 </span>                :                         break;
<span class="lineNum">     125 </span>                :                 case IS_ARRAY:
<span class="lineNum">     126 </span><span class="lineCov">              7 :                         result = (zend_hash_num_elements(Z_ARRVAL_P(op))?1:0);</span>
<span class="lineNum">     127 </span>                :                         break;
<span class="lineNum">     128 </span>                :                 case IS_OBJECT:
<span class="lineNum">     129 </span><span class="lineNoCov">              0 :                         if(IS_ZEND_STD_OBJECT(*op)) {</span>
<span class="lineNum">     130 </span>                :                                 TSRMLS_FETCH();
<span class="lineNum">     131 </span>                : 
<span class="lineNum">     132 </span><span class="lineNoCov">              0 :                                 if (Z_OBJ_HT_P(op)-&gt;cast_object) {</span>
<span class="lineNum">     133 </span>                :                                         zval tmp;
<span class="lineNum">     134 </span><span class="lineNoCov">              0 :                                         if (Z_OBJ_HT_P(op)-&gt;cast_object(op, &amp;tmp, IS_BOOL TSRMLS_CC) == SUCCESS) {</span>
<span class="lineNum">     135 </span><span class="lineNoCov">              0 :                                                 result = Z_LVAL(tmp);</span>
<span class="lineNum">     136 </span>                :                                                 break;
<span class="lineNum">     137 </span>                :                                         }
<span class="lineNum">     138 </span><span class="lineNoCov">              0 :                                 } else if (Z_OBJ_HT_P(op)-&gt;get) {</span>
<span class="lineNum">     139 </span><span class="lineNoCov">              0 :                                         zval *tmp = Z_OBJ_HT_P(op)-&gt;get(op TSRMLS_CC);</span>
<span class="lineNum">     140 </span><span class="lineNoCov">              0 :                                         if(Z_TYPE_P(tmp) != IS_OBJECT) {</span>
<span class="lineNum">     141 </span>                :                                                 /* for safety - avoid loop */
<span class="lineNum">     142 </span><span class="lineNoCov">              0 :                                                 convert_to_boolean(tmp);</span>
<span class="lineNum">     143 </span><span class="lineNoCov">              0 :                                                 result = Z_LVAL_P(tmp);</span>
<span class="lineNum">     144 </span><span class="lineNoCov">              0 :                                                 zval_ptr_dtor(&amp;tmp);</span>
<span class="lineNum">     145 </span>                :                                                 break;
<span class="lineNum">     146 </span>                :                                         }
<span class="lineNum">     147 </span>                :                                 }
<span class="lineNum">     148 </span>                :                         }
<span class="lineNum">     149 </span><span class="lineNoCov">              0 :                         result = 1;</span>
<span class="lineNum">     150 </span>                :                         break;
<span class="lineNum">     151 </span>                :                 default:
<span class="lineNum">     152 </span><span class="lineNoCov">              0 :                         result = 0;</span>
<span class="lineNum">     153 </span>                :                         break;
<span class="lineNum">     154 </span>                :         }
<span class="lineNum">     155 </span><span class="lineCov">          37019 :         return result;</span>
<span class="lineNum">     156 </span>                : }
<span class="lineNum">     157 </span>                : 
<span class="lineNum">     158 </span>                : ZEND_API int zval_update_constant(zval **pp, void *arg TSRMLS_DC);
<span class="lineNum">     159 </span>                : ZEND_API int zval_update_constant_inline_change(zval **pp, void *arg TSRMLS_DC);
<span class="lineNum">     160 </span>                : ZEND_API int zval_update_constant_no_inline_change(zval **pp, void *arg TSRMLS_DC);
<span class="lineNum">     161 </span>                : ZEND_API int zval_update_constant_ex(zval **pp, void *arg, zend_class_entry *scope TSRMLS_DC);
<span class="lineNum">     162 </span>                : 
<span class="lineNum">     163 </span>                : /* dedicated Zend executor functions - do not use! */
<span class="lineNum">     164 </span>                : #define ZEND_VM_STACK_PAGE_SIZE ((16 * 1024) - 16)
<span class="lineNum">     165 </span>                : 
<span class="lineNum">     166 </span>                : struct _zend_vm_stack {
<span class="lineNum">     167 </span>                :         void **top;
<span class="lineNum">     168 </span>                :         void **end;
<span class="lineNum">     169 </span>                :         zend_vm_stack prev;
<span class="lineNum">     170 </span>                : };
<span class="lineNum">     171 </span>                : 
<span class="lineNum">     172 </span>                : #define ZEND_VM_STACK_ELEMETS(stack) \
<span class="lineNum">     173 </span>                :         ((void**)(((char*)(stack)) + ZEND_MM_ALIGNED_SIZE(sizeof(struct _zend_vm_stack))))
<span class="lineNum">     174 </span>                : 
<span class="lineNum">     175 </span>                : #define ZEND_VM_STACK_GROW_IF_NEEDED(count)                                                     \
<span class="lineNum">     176 </span>                :         do {                                                                                                                    \
<span class="lineNum">     177 </span>                :                 if (UNEXPECTED((count) &gt;                                                                     \
<span class="lineNum">     178 </span>                :                     EG(argument_stack)-&gt;end - EG(argument_stack)-&gt;top)) { \
<span class="lineNum">     179 </span>                :                         zend_vm_stack_extend((count) TSRMLS_CC);                                \
<span class="lineNum">     180 </span>                :                 }                                                                                                                       \
<span class="lineNum">     181 </span>                :         } while (0)
<span class="lineNum">     182 </span>                : 
<span class="lineNum">     183 </span>                : static zend_always_inline zend_vm_stack zend_vm_stack_new_page(int count) {
<span class="lineNum">     184 </span><span class="lineCov">             48 :         zend_vm_stack page = (zend_vm_stack)emalloc(ZEND_MM_ALIGNED_SIZE(sizeof(*page)) + sizeof(void*) * count);</span>
<span class="lineNum">     185 </span>                : 
<span class="lineNum">     186 </span><span class="lineCov">             48 :         page-&gt;top = ZEND_VM_STACK_ELEMETS(page);</span>
<span class="lineNum">     187 </span><span class="lineCov">             48 :         page-&gt;end = page-&gt;top + count;</span>
<span class="lineNum">     188 </span><span class="lineCov">             48 :         page-&gt;prev = NULL;</span>
<span class="lineNum">     189 </span><span class="lineCov">             48 :         return page;</span>
<span class="lineNum">     190 </span>                : }
<span class="lineNum">     191 </span>                : 
<span class="lineNum">     192 </span>                : static zend_always_inline void zend_vm_stack_init(TSRMLS_D)
<span class="lineNum">     193 </span>                : {
<span class="lineNum">     194 </span><span class="lineCov">             48 :         EG(argument_stack) = zend_vm_stack_new_page(ZEND_VM_STACK_PAGE_SIZE);</span>
<span class="lineNum">     195 </span>                : }
<span class="lineNum">     196 </span>                : 
<span class="lineNum">     197 </span>                : static zend_always_inline void zend_vm_stack_destroy(TSRMLS_D)
<span class="lineNum">     198 </span>                : {
<span class="lineNum">     199 </span><span class="lineCov">             48 :         zend_vm_stack stack = EG(argument_stack);</span>
<span class="lineNum">     200 </span>                : 
<span class="lineNum">     201 </span><span class="lineCov">             96 :         while (stack != NULL) {</span>
<span class="lineNum">     202 </span><span class="lineCov">             48 :                 zend_vm_stack p = stack-&gt;prev;</span>
<span class="lineNum">     203 </span><span class="lineCov">             48 :                 efree(stack);</span>
<span class="lineNum">     204 </span><span class="lineCov">             48 :                 stack = p;</span>
<span class="lineNum">     205 </span>                :         }
<span class="lineNum">     206 </span>                : }
<span class="lineNum">     207 </span>                : 
<span class="lineNum">     208 </span>                : static zend_always_inline void zend_vm_stack_extend(int count TSRMLS_DC)
<span class="lineNum">     209 </span>                : {
<span class="lineNum">     210 </span><span class="lineNoCov">              0 :         zend_vm_stack p = zend_vm_stack_new_page(count &gt;= ZEND_VM_STACK_PAGE_SIZE ? count : ZEND_VM_STACK_PAGE_SIZE);</span>
<span class="lineNum">     211 </span><span class="lineNoCov">              0 :         p-&gt;prev = EG(argument_stack);</span>
<span class="lineNum">     212 </span><span class="lineNoCov">              0 :         EG(argument_stack) = p;</span>
<span class="lineNum">     213 </span>                : }
<span class="lineNum">     214 </span>                : 
<span class="lineNum">     215 </span>                : static zend_always_inline void **zend_vm_stack_top(TSRMLS_D)
<span class="lineNum">     216 </span>                : {
<span class="lineNum">     217 </span><span class="lineCov">         109745 :         return EG(argument_stack)-&gt;top;</span>
<span class="lineNum">     218 </span>                : }
<span class="lineNum">     219 </span>                : 
<span class="lineNum">     220 </span>                : static zend_always_inline void zend_vm_stack_push(void *ptr TSRMLS_DC)
<span class="lineNum">     221 </span>                : {
<span class="lineNum">     222 </span><span class="lineCov">         147194 :         ZEND_VM_STACK_GROW_IF_NEEDED(1);</span>
<span class="lineNum">     223 </span><span class="lineCov">         147194 :         *(EG(argument_stack)-&gt;top++) = ptr;</span>
<span class="lineNum">     224 </span>                : }
<span class="lineNum">     225 </span>                : 
<span class="lineNum">     226 </span>                : static zend_always_inline void zend_vm_stack_push_nocheck(void *ptr TSRMLS_DC)
<span class="lineNum">     227 </span>                : {
<span class="lineNum">     228 </span><span class="lineCov">           2856 :         *(EG(argument_stack)-&gt;top++) = ptr;</span>
<span class="lineNum">     229 </span>                : }
<span class="lineNum">     230 </span>                : 
<span class="lineNum">     231 </span>                : static zend_always_inline void *zend_vm_stack_pop(TSRMLS_D)
<span class="lineNum">     232 </span>                : {
<span class="lineNum">     233 </span><span class="lineCov">          23037 :         void *el = *(--EG(argument_stack)-&gt;top);</span>
<span class="lineNum">     234 </span>                : 
<span class="lineNum">     235 </span><span class="lineCov">          23037 :         if (UNEXPECTED(EG(argument_stack)-&gt;top == ZEND_VM_STACK_ELEMETS(EG(argument_stack)))) {</span>
<span class="lineNum">     236 </span><span class="lineNoCov">              0 :                 zend_vm_stack p = EG(argument_stack);</span>
<span class="lineNum">     237 </span><span class="lineNoCov">              0 :                 EG(argument_stack) = p-&gt;prev;</span>
<span class="lineNum">     238 </span><span class="lineNoCov">              0 :                 efree(p);</span>
<span class="lineNum">     239 </span>                :         }
<span class="lineNum">     240 </span><span class="lineCov">          23037 :         return el;</span>
<span class="lineNum">     241 </span>                : }
<span class="lineNum">     242 </span>                : 
<span class="lineNum">     243 </span>                : static zend_always_inline void *zend_vm_stack_alloc(size_t size TSRMLS_DC)
<span class="lineNum">     244 </span>                : {
<span class="lineNum">     245 </span>                :         void *ret;
<span class="lineNum">     246 </span>                : 
<span class="lineNum">     247 </span><span class="lineCov">          13331 :         size = (size + (sizeof(void*) - 1)) / sizeof(void*);</span>
<span class="lineNum">     248 </span>                : 
<span class="lineNum">     249 </span>                :         /* the following comparison must be optimized out at compile time */
<span class="lineNum">     250 </span>                :         if (ZEND_MM_ALIGNMENT &gt; sizeof(void*)) {
<span class="lineNum">     251 </span>                :                 int extra = (ZEND_MM_ALIGNMENT - ((zend_uintptr_t)EG(argument_stack)-&gt;top &amp; (ZEND_MM_ALIGNMENT - 1))) / sizeof(void*);
<span class="lineNum">     252 </span>                : 
<span class="lineNum">     253 </span>                :                 if (UNEXPECTED(size + extra + ZEND_MM_ALIGNED_SIZE(sizeof(void*)) / sizeof(void*) &gt;
<span class="lineNum">     254 </span>                :                     (zend_uintptr_t)(EG(argument_stack)-&gt;end - EG(argument_stack)-&gt;top))) {
<span class="lineNum">     255 </span>                :                         zend_vm_stack_extend(size TSRMLS_CC);
<span class="lineNum">     256 </span>                :                 } else {
<span class="lineNum">     257 </span>                :                         void **old_top = EG(argument_stack)-&gt;top;
<span class="lineNum">     258 </span>                : 
<span class="lineNum">     259 </span>                :                         EG(argument_stack)-&gt;top += extra;
<span class="lineNum">     260 </span>                :                         /* store old top on the stack */
<span class="lineNum">     261 </span>                :                         *EG(argument_stack)-&gt;top = (void*)old_top;
<span class="lineNum">     262 </span>                :                         EG(argument_stack)-&gt;top += ZEND_MM_ALIGNED_SIZE(sizeof(void*)) / sizeof(void*);
<span class="lineNum">     263 </span>                :                 }
<span class="lineNum">     264 </span>                :         } else {
<span class="lineNum">     265 </span><span class="lineCov">          13331 :                 ZEND_VM_STACK_GROW_IF_NEEDED((int)size);</span>
<span class="lineNum">     266 </span>                :         }
<span class="lineNum">     267 </span><span class="lineCov">          13331 :         ret = (void*)EG(argument_stack)-&gt;top;</span>
<span class="lineNum">     268 </span><span class="lineCov">          13331 :         EG(argument_stack)-&gt;top += size;</span>
<span class="lineNum">     269 </span><span class="lineCov">          13331 :         return ret;</span>
<span class="lineNum">     270 </span>                : }
<span class="lineNum">     271 </span>                : 
<span class="lineNum">     272 </span>                : static zend_always_inline void zend_vm_stack_free_int(void *ptr TSRMLS_DC)
<span class="lineNum">     273 </span>                : {       
<span class="lineNum">     274 </span><span class="lineCov">          47101 :         if (UNEXPECTED(ZEND_VM_STACK_ELEMETS(EG(argument_stack)) == (void**)ptr)) {</span>
<span class="lineNum">     275 </span><span class="lineNoCov">              0 :                 zend_vm_stack p = EG(argument_stack);</span>
<span class="lineNum">     276 </span>                : 
<span class="lineNum">     277 </span><span class="lineNoCov">              0 :                 EG(argument_stack) = p-&gt;prev;</span>
<span class="lineNum">     278 </span><span class="lineNoCov">              0 :                 efree(p);</span>
<span class="lineNum">     279 </span>                :         } else {
<span class="lineNum">     280 </span><span class="lineCov">          47101 :                 EG(argument_stack)-&gt;top = (void**)ptr;</span>
<span class="lineNum">     281 </span>                :         }
<span class="lineNum">     282 </span>                : }
<span class="lineNum">     283 </span>                : 
<span class="lineNum">     284 </span>                : static zend_always_inline void zend_vm_stack_free(void *ptr TSRMLS_DC)
<span class="lineNum">     285 </span>                : {       
<span class="lineNum">     286 </span><span class="lineCov">          13328 :         if (UNEXPECTED(ZEND_VM_STACK_ELEMETS(EG(argument_stack)) == (void**)ptr)) {</span>
<span class="lineNum">     287 </span><span class="lineNoCov">              0 :                 zend_vm_stack p = EG(argument_stack);</span>
<span class="lineNum">     288 </span>                : 
<span class="lineNum">     289 </span><span class="lineNoCov">              0 :                 EG(argument_stack) = p-&gt;prev;</span>
<span class="lineNum">     290 </span><span class="lineNoCov">              0 :                 efree(p);</span>
<span class="lineNum">     291 </span>                :         } else {
<span class="lineNum">     292 </span>                :                 /* the following comparison must be optimized out at compile time */
<span class="lineNum">     293 </span>                :                 if (ZEND_MM_ALIGNMENT &gt; sizeof(void*)) {
<span class="lineNum">     294 </span>                :                         ptr = (void*)(((char*)ptr) - ZEND_MM_ALIGNED_SIZE(sizeof(void*)));
<span class="lineNum">     295 </span>                :                         EG(argument_stack)-&gt;top = *(void***)ptr;
<span class="lineNum">     296 </span>                :                 } else {
<span class="lineNum">     297 </span><span class="lineCov">          13328 :                         EG(argument_stack)-&gt;top = (void**)ptr;</span>
<span class="lineNum">     298 </span>                :                 }
<span class="lineNum">     299 </span>                :         }
<span class="lineNum">     300 </span>                : }
<span class="lineNum">     301 </span>                : 
<span class="lineNum">     302 </span>                : static zend_always_inline void** zend_vm_stack_push_args(int count TSRMLS_DC)
<span class="lineNum">     303 </span>                : {
<span class="lineNum">     304 </span>                : 
<span class="lineNum">     305 </span><span class="lineCov">          91508 :         if (UNEXPECTED(EG(argument_stack)-&gt;top - ZEND_VM_STACK_ELEMETS(EG(argument_stack)) &lt; count)  || </span>
<span class="lineNum">     306 </span><span class="lineCov">          45754 :                 UNEXPECTED(EG(argument_stack)-&gt;top == EG(argument_stack)-&gt;end)) {</span>
<span class="lineNum">     307 </span><span class="lineNoCov">              0 :                 zend_vm_stack p = EG(argument_stack);</span>
<span class="lineNum">     308 </span>                : 
<span class="lineNum">     309 </span><span class="lineNoCov">              0 :                 zend_vm_stack_extend(count + 1 TSRMLS_CC);</span>
<span class="lineNum">     310 </span>                : 
<span class="lineNum">     311 </span><span class="lineNoCov">              0 :                 EG(argument_stack)-&gt;top += count;</span>
<span class="lineNum">     312 </span><span class="lineNoCov">              0 :                 *(EG(argument_stack)-&gt;top) = (void*)(zend_uintptr_t)count;</span>
<span class="lineNum">     313 </span><span class="lineNoCov">              0 :                 while (count-- &gt; 0) {</span>
<span class="lineNum">     314 </span><span class="lineNoCov">              0 :                         void *data = *(--p-&gt;top);</span>
<span class="lineNum">     315 </span>                : 
<span class="lineNum">     316 </span><span class="lineNoCov">              0 :                         if (UNEXPECTED(p-&gt;top == ZEND_VM_STACK_ELEMETS(p))) {</span>
<span class="lineNum">     317 </span><span class="lineNoCov">              0 :                                 zend_vm_stack r = p;</span>
<span class="lineNum">     318 </span>                : 
<span class="lineNum">     319 </span><span class="lineNoCov">              0 :                                 EG(argument_stack)-&gt;prev = p-&gt;prev;</span>
<span class="lineNum">     320 </span><span class="lineNoCov">              0 :                                 p = p-&gt;prev;</span>
<span class="lineNum">     321 </span><span class="lineNoCov">              0 :                                 efree(r);</span>
<span class="lineNum">     322 </span>                :                         }
<span class="lineNum">     323 </span><span class="lineNoCov">              0 :                         *(ZEND_VM_STACK_ELEMETS(EG(argument_stack)) + count) = data;</span>
<span class="lineNum">     324 </span>                :                 }
<span class="lineNum">     325 </span><span class="lineNoCov">              0 :                 return EG(argument_stack)-&gt;top++;</span>
<span class="lineNum">     326 </span>                :         }
<span class="lineNum">     327 </span><span class="lineCov">          45754 :         *(EG(argument_stack)-&gt;top) = (void*)(zend_uintptr_t)count;</span>
<span class="lineNum">     328 </span><span class="lineCov">          45754 :         return EG(argument_stack)-&gt;top++;</span>
<span class="lineNum">     329 </span>                : }
<span class="lineNum">     330 </span>                : 
<span class="lineNum">     331 </span>                : static zend_always_inline void zend_vm_stack_clear_multiple(TSRMLS_D)
<span class="lineNum">     332 </span>                : {
<span class="lineNum">     333 </span><span class="lineCov">          47101 :         void **p = EG(argument_stack)-&gt;top - 1;</span>
<span class="lineNum">     334 </span><span class="lineCov">          47101 :         int delete_count = (int)(zend_uintptr_t) *p;</span>
<span class="lineNum">     335 </span>                : 
<span class="lineNum">     336 </span><span class="lineCov">         172717 :         while (--delete_count&gt;=0) {</span>
<span class="lineNum">     337 </span><span class="lineCov">         125616 :                 zval *q = *(zval **)(--p);</span>
<span class="lineNum">     338 </span><span class="lineCov">         125616 :                 *p = NULL;</span>
<span class="lineNum">     339 </span>                :                 i_zval_ptr_dtor(q ZEND_FILE_LINE_CC);
<span class="lineNum">     340 </span>                :         }
<span class="lineNum">     341 </span>                :         zend_vm_stack_free_int(p TSRMLS_CC);
<span class="lineNum">     342 </span>                : }
<span class="lineNum">     343 </span>                : 
<span class="lineNum">     344 </span>                : static zend_always_inline zval** zend_vm_stack_get_arg(int requested_arg TSRMLS_DC)
<span class="lineNum">     345 </span>                : {
<span class="lineNum">     346 </span><span class="lineCov">          70112 :         void **p = EG(current_execute_data)-&gt;prev_execute_data-&gt;function_state.arguments;</span>
<span class="lineNum">     347 </span><span class="lineCov">          70112 :         int arg_count = (int)(zend_uintptr_t) *p;</span>
<span class="lineNum">     348 </span>                : 
<span class="lineNum">     349 </span><span class="lineCov">          70112 :         if (UNEXPECTED(requested_arg &gt; arg_count)) {</span>
<span class="lineNum">     350 </span><span class="lineCov">            193 :                 return NULL;</span>
<span class="lineNum">     351 </span>                :         }
<span class="lineNum">     352 </span><span class="lineCov">          69919 :         return (zval**)p - arg_count + requested_arg - 1;</span>
<span class="lineNum">     353 </span>                : }
<span class="lineNum">     354 </span>                : 
<span class="lineNum">     355 </span>                : static zend_always_inline void zend_arg_types_stack_2_pop(zend_ptr_stack *stack, zval **object, zend_function **fbc)
<span class="lineNum">     356 </span>                : {
<span class="lineNum">     357 </span>                :         void *a, *b;
<span class="lineNum">     358 </span>                : 
<span class="lineNum">     359 </span>                :         zend_ptr_stack_2_pop(stack, &amp;a, &amp;b);
<span class="lineNum">     360 </span>                : 
<span class="lineNum">     361 </span><span class="lineNoCov">              0 :         *object = (zval *) a;</span>
<span class="lineNum">     362 </span><span class="lineNoCov">              0 :         *fbc = (zend_function *) b;</span>
<span class="lineNum">     363 </span>                : }
<span class="lineNum">     364 </span>                : 
<span class="lineNum">     365 </span>                : static zend_always_inline void zend_arg_types_stack_3_pop(zend_ptr_stack *stack, zend_class_entry **called_scope, zval **object, zend_function **fbc)
<span class="lineNum">     366 </span>                : {
<span class="lineNum">     367 </span>                :         void *a, *b, *c;
<span class="lineNum">     368 </span>                : 
<span class="lineNum">     369 </span>                :         zend_ptr_stack_3_pop(stack, &amp;a, &amp;b, &amp;c);
<span class="lineNum">     370 </span>                : 
<span class="lineNum">     371 </span><span class="lineCov">          45754 :         *called_scope = (zend_class_entry *) a;</span>
<span class="lineNum">     372 </span><span class="lineCov">          45754 :         *object = (zval *) b;</span>
<span class="lineNum">     373 </span><span class="lineCov">          45754 :         *fbc = (zend_function *) c;</span>
<span class="lineNum">     374 </span>                : }
<span class="lineNum">     375 </span>                : 
<span class="lineNum">     376 </span>                : void execute_new_code(TSRMLS_D);
<span class="lineNum">     377 </span>                : 
<span class="lineNum">     378 </span>                : 
<span class="lineNum">     379 </span>                : /* services */
<span class="lineNum">     380 </span>                : ZEND_API const char *get_active_class_name(const char **space TSRMLS_DC);
<span class="lineNum">     381 </span>                : ZEND_API const char *get_active_function_name(TSRMLS_D);
<span class="lineNum">     382 </span>                : ZEND_API const char *zend_get_executed_filename(TSRMLS_D);
<span class="lineNum">     383 </span>                : ZEND_API uint zend_get_executed_lineno(TSRMLS_D);
<span class="lineNum">     384 </span>                : ZEND_API zend_bool zend_is_executing(TSRMLS_D);
<span class="lineNum">     385 </span>                : 
<span class="lineNum">     386 </span>                : ZEND_API void zend_set_timeout(long seconds, int reset_signals);
<span class="lineNum">     387 </span>                : ZEND_API void zend_unset_timeout(TSRMLS_D);
<span class="lineNum">     388 </span>                : ZEND_API void zend_timeout(int dummy);
<span class="lineNum">     389 </span>                : ZEND_API zend_class_entry *zend_fetch_class(const char *class_name, uint class_name_len, int fetch_type TSRMLS_DC);
<span class="lineNum">     390 </span>                : ZEND_API zend_class_entry *zend_fetch_class_by_name(const char *class_name, uint class_name_len, const zend_literal *key, int fetch_type TSRMLS_DC);
<span class="lineNum">     391 </span>                : void zend_verify_abstract_class(zend_class_entry *ce TSRMLS_DC);
<span class="lineNum">     392 </span>                : 
<span class="lineNum">     393 </span>                : #ifdef ZEND_WIN32
<span class="lineNum">     394 </span>                : void zend_init_timeout_thread(void);
<span class="lineNum">     395 </span>                : void zend_shutdown_timeout_thread(void);
<span class="lineNum">     396 </span>                : #define WM_REGISTER_ZEND_TIMEOUT                (WM_USER+1)
<span class="lineNum">     397 </span>                : #define WM_UNREGISTER_ZEND_TIMEOUT              (WM_USER+2)
<span class="lineNum">     398 </span>                : #endif
<span class="lineNum">     399 </span>                : 
<span class="lineNum">     400 </span>                : #define zendi_zval_copy_ctor(p) zval_copy_ctor(&amp;(p))
<span class="lineNum">     401 </span>                : #define zendi_zval_dtor(p) zval_dtor(&amp;(p))
<span class="lineNum">     402 </span>                : 
<span class="lineNum">     403 </span>                : #define active_opline (*EG(opline_ptr))
<span class="lineNum">     404 </span>                : 
<span class="lineNum">     405 </span>                : /* The following tries to resolve the classname of a zval of type object.
<span class="lineNum">     406 </span>                :  * Since it is slow it should be only used in error messages.
<span class="lineNum">     407 </span>                :  */
<span class="lineNum">     408 </span>                : #define Z_OBJ_CLASS_NAME_P(zval) ((zval) &amp;&amp; Z_TYPE_P(zval) == IS_OBJECT &amp;&amp; Z_OBJ_HT_P(zval)-&gt;get_class_entry != NULL &amp;&amp; Z_OBJ_HT_P(zval)-&gt;get_class_entry(zval TSRMLS_CC) ? Z_OBJ_HT_P(zval)-&gt;get_class_entry(zval TSRMLS_CC)-&gt;name : &quot;&quot;)
<span class="lineNum">     409 </span>                : 
<span class="lineNum">     410 </span>                : ZEND_API zval** zend_get_compiled_variable_value(const zend_execute_data *execute_data_ptr, zend_uint var);
<span class="lineNum">     411 </span>                : 
<span class="lineNum">     412 </span>                : #define ZEND_USER_OPCODE_CONTINUE   0 /* execute next opcode */
<span class="lineNum">     413 </span>                : #define ZEND_USER_OPCODE_RETURN     1 /* exit from executor (return from function) */
<span class="lineNum">     414 </span>                : #define ZEND_USER_OPCODE_DISPATCH   2 /* call original opcode handler */
<span class="lineNum">     415 </span>                : #define ZEND_USER_OPCODE_ENTER      3 /* enter into new op_array without recursion */
<span class="lineNum">     416 </span>                : #define ZEND_USER_OPCODE_LEAVE      4 /* return to calling op_array within the same executor */
<span class="lineNum">     417 </span>                : 
<span class="lineNum">     418 </span>                : #define ZEND_USER_OPCODE_DISPATCH_TO 0x100 /* call original handler of returned opcode */
<span class="lineNum">     419 </span>                : 
<span class="lineNum">     420 </span>                : ZEND_API int zend_set_user_opcode_handler(zend_uchar opcode, user_opcode_handler_t handler);
<span class="lineNum">     421 </span>                : ZEND_API user_opcode_handler_t zend_get_user_opcode_handler(zend_uchar opcode);
<span class="lineNum">     422 </span>                : 
<span class="lineNum">     423 </span>                : /* former zend_execute_locks.h */
<span class="lineNum">     424 </span>                : typedef struct _zend_free_op {
<span class="lineNum">     425 </span>                :         zval* var;
<span class="lineNum">     426 </span>                : /*      int   is_var; */
<span class="lineNum">     427 </span>                : } zend_free_op;
<span class="lineNum">     428 </span>                : 
<span class="lineNum">     429 </span>                : ZEND_API zval *zend_get_zval_ptr(int op_type, const znode_op *node, const temp_variable *Ts, zend_free_op *should_free, int type TSRMLS_DC);
<span class="lineNum">     430 </span>                : ZEND_API zval **zend_get_zval_ptr_ptr(int op_type, const znode_op *node, const temp_variable *Ts, zend_free_op *should_free, int type TSRMLS_DC);
<span class="lineNum">     431 </span>                : 
<span class="lineNum">     432 </span>                : ZEND_API int zend_do_fcall(ZEND_OPCODE_HANDLER_ARGS);
<span class="lineNum">     433 </span>                : 
<span class="lineNum">     434 </span>                : #define CACHED_PTR(num) \
<span class="lineNum">     435 </span>                :         EG(active_op_array)-&gt;run_time_cache[(num)]
<span class="lineNum">     436 </span>                : 
<span class="lineNum">     437 </span>                : #define CACHE_PTR(num, ptr) do { \
<span class="lineNum">     438 </span>                :                 EG(active_op_array)-&gt;run_time_cache[(num)] = (ptr); \
<span class="lineNum">     439 </span>                :         } while (0)
<span class="lineNum">     440 </span>                : 
<span class="lineNum">     441 </span>                : #define CACHED_POLYMORPHIC_PTR(num, ce) \
<span class="lineNum">     442 </span>                :         ((EG(active_op_array)-&gt;run_time_cache[(num)] == (ce)) ? \
<span class="lineNum">     443 </span>                :                 EG(active_op_array)-&gt;run_time_cache[(num) + 1] : \
<span class="lineNum">     444 </span>                :                 NULL)
<span class="lineNum">     445 </span>                : 
<span class="lineNum">     446 </span>                : #define CACHE_POLYMORPHIC_PTR(num, ce, ptr) do { \
<span class="lineNum">     447 </span>                :                 EG(active_op_array)-&gt;run_time_cache[(num)] = (ce); \
<span class="lineNum">     448 </span>                :                 EG(active_op_array)-&gt;run_time_cache[(num) + 1] = (ptr); \
<span class="lineNum">     449 </span>                :         } while (0)
<span class="lineNum">     450 </span>                : 
<span class="lineNum">     451 </span>                : END_EXTERN_C()
<span class="lineNum">     452 </span>                : 
<span class="lineNum">     453 </span>                : #endif /* ZEND_EXECUTE_H */
<span class="lineNum">     454 </span>                : 
<span class="lineNum">     455 </span>                : /*
<span class="lineNum">     456 </span>                :  * Local variables:
<span class="lineNum">     457 </span>                :  * tab-width: 4
<span class="lineNum">     458 </span>                :  * c-basic-offset: 4
<span class="lineNum">     459 </span>                :  * indent-tabs-mode: t
<span class="lineNum">     460 </span>                :  * End:
<span class="lineNum">     461 </span>                :  */
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
  <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.7</a></td></tr>
  </table>
  <br>

</body>
</html>
